create table staging2
SELECT * FROM (Select
Date_Added as src_Date_Added, Date_Added as trgt_Date_Added,
Category as src_Category, Category as trgt_Category,
Sellerlink as src_Sellerlink, Sellerlink as trgt_Sellerlink,
Sellerlinkurl as src_Sellerlink_url, Sellerlinkurl as trgt_Sellerlink_url,
Sellerstorefronturl as src_Sellerstorefront_url, Sellerstorefronturl as trgt_Sellerstorefront_url,
sellerproductcount as src_sellerproductcount, substring_index(substring_index(sellerproductcount,' ',-2),' ',1) as trgt_ProductCount,
sellerratings as src_sellerratings, substring_index(substring_index(sellerratings,'(',-1),' ',1) as trgt_sellerratings,
sellerratings as src_PositivePercentage, substring_index(sellerratings,'%',1) as trgt_PositivePercentage,
sellerdetails as src_sellerdetails, sellerdetails as trgt_sellerdetails,
sellerdetails as src_EmailID,
concat(substring_index(substring_index(sellerdetails,'@',1),' ',-1), substring_index(substring_index(sellerdetails, substring_index(sellerdetails,'@',1),-1),' ',1)) as trgt_EmailID,
seller_business_name as src_seller_business_name, substring_index(seller_business_name,':',-1) as trgt_seller_business_name,
businessaddress as src_businessaddress, businessaddress as trgt_businessaddress,
businessaddress as src_CountryCode, Right(businessaddress,2) as trgt_CountryCode,
Count_of_seller_brands as src_Count_of_seller_brands, Count_of_seller_brands as trgt_Count_of_seller_brands,
Max_of_negative_seller_ratings_last_30_days as src_NSR_last30, Max_of_negative_seller_ratings_last_30_days as trgt_src_NSR_last30,
Max_of_negative_seller_ratings_last_90_days as src_NSR_last90, Max_of_negative_seller_ratings_last_90_days as trgt_src_NSR_last90,
Max_of_negative_seller_ratings_last_12_months as src_NSR_last12_Mon, Max_of_negative_seller_ratings_last_12_months as trgt_NSR_last12_Mon,
Hero_Product_1_ratings as src_Hero_Product1, Hero_Product_1_ratings as trgt_Hero_Product1,
Hero_Product_2_ratings as src_Hero_Product2, Hero_Product_2_ratings as trgt_Hero_Product2,
Sample_brand_name as src_Sample_brand_name, Sample_brand_name as trgt_Sample_brand_name,
Sample_Brand_URL as src_Sample_Brand_URL, Sample_Brand_URL as trgt_Sample_Brand_URL
From Original
) as X
where
(
X.src_sellerproductcount is not null OR
X.src_sellerratings is not null OR
X.src_PositivePercentage is not null OR
X.src_EmailID like '%@%' and X.src_sellerdetails is not null OR X.src_seller_business_name is not null
) and RIGHT(X.src_CountryCode,2) != 'CN'
